PQN
C
C -- Clear the &PARTFILES& definitions if they exist already
C
HSELECT &PARTFILES& WITH DISTFILE = "SPREAD.ORDERS"
STON
HDELETE &PARTFILES&<
HY
PP
C
C -- Create the part algorithm with a simple MOD or remainder + 1
C
HAE DICT VOCLIB ORD.SPREAD
STON
HI<
HI<
HMOD(@ID,3) + "1"<
HMR0<
HPART#<
H5R<
H<
HFI<
PP
C
C -- Create the DISTRIBUTED file stub and DICT
C
HDEFINE.DF SPREAD.ORDERS
PP
C
C -- Change the distribution algorithm to use as created above
C
HDEFINE.DF SPREAD.ORDERS INTERNAL VOCLIB ORD.SPREAD
PP
C
C -- Create the 3 part files as regular type 3 64 bit files
C
HCREATE-FILE ORDERS1 3 59 64BIT
PP
HCREATE-FILE ORDERS2 3 59 64BIT
PP
HCREATE-FILE ORDERS3 3 59 64BIT
PP
C
C -- Copy the DICT items from the original ORDERS to all the parts and distributed file DICT
C
HCOPY FROM DICT ORDERS TO DICT ORDERS1 ALL
PP
HCOPY FROM DICT ORDERS TO DICT ORDERS2 ALL
PP
HCOPY FROM DICT ORDERS TO DICT ORDERS3 ALL
PP
HCOPY FROM DICT ORDERS TO DICT SPREAD.ORDERS ALL
PP
C
C -- Define the 3 part files
C
HDEFINE.DF SPREAD.ORDERS ADDING ORDERS1 1 INTERNAL VOCLIB ORD.SPREAD
PP
HDEFINE.DF SPREAD.ORDERS ADDING ORDERS2 2 INTERNAL VOCLIB ORD.SPREAD
PP
HDEFINE.DF SPREAD.ORDERS ADDING ORDERS3 3 INTERNAL VOCLIB ORD.SPREAD
PP
C
C -- Copy all the orders to the SPREAD.ORDERS distributed file
C
HCOPY FROM ORDERS TO SPREAD.ORDERS ALL
PP
